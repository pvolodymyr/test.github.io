(()=>{"use strict";const e="radio button",t="https://searchwidget-ezt.pages.dev/data_makes.json",i="https://searchwidget-ezt.pages.dev/states_of_USA.json",s=()=>String(Date.now().toString(32)+Math.random().toString(16)).replace(/\./g,"");const a=e=>e&&"function"==typeof e,n={numbersOnly:(e,t)=>{const i=e.trimStart(),s=t.trimStart();if(""===s)return s;const a=parseInt(s);return isNaN(a)||a<0||!/^\d+$/.test(s)?i:s},lettersOnly:(e,t)=>{const i=e.trimStart(),s=t.trimStart();return""===s||/^[a-zA-Z ]+$/.test(s)?s:i},lettersAndNumbers:(e,t)=>{const i=e.trimStart(),s=t.trimStart();return""===s||/^[a-zA-Z0-9]+$/.test(s)?s:i},carModelCharacters:(e,t)=>{const i=e.trimStart(),s=t.trimStart();return""===s||/^[a-zA-Z0-9\-_ ./&]+$/.test(s)?s:i}},l=(e="")=>e.trim().toLowerCase(),o=(e,t)=>{const i=t.filter((({name:t})=>l(t).startsWith(l(e))));if(1===i.length)return i[0];return i.find((({name:t})=>l(t)===l(e)))},r={modelYear:(e,t)=>{if(e.length>=2)return t.find((({name:t})=>t.endsWith(e)))},state:(e,t)=>{if(e.length>=2){const i=((e,t)=>t.find((({value:t})=>l(t)===l(e))))(e,t);return i||o(e,t)}},makeModel:(e,t)=>e?o(e,t):""},h=(e=["includes"])=>(t="",i=[],s=[])=>i.filter((i=>e.some((e=>s.some((s=>i[s].toLowerCase()[e](t.toLowerCase()))))))),d={startsWidth:h(["startsWith"]),endsWidth:h(["endsWith"]),startsOrEndsWidth:h(["startsWith","endsWith"])},u="empty",c="invalid",m="incomplete",p="valid",E={matchOptionNameProp:(e="",t=[])=>e.trim()?t.find((e=>({name:t})=>l(t)===l(e))(e))?p:c:u,mileage:(e="")=>e.trim()?e>=0&&e<=999999?p:c:u,licensePlate:(e="")=>{const t=((e="")=>e.replace(/\s/g,""))(e);return t?t.length<2?m:p:u}},b="We couldn't find a car matching your license plate. Please check for errors or search with your make and model.",g="Something went wrong, please try again or search via make and model",v=(e="")=>"no result found"===e.toLowerCase()?b:g,f="license_plate_form",S="manufacturer_form",y="extended",F="compact",L=(e,t)=>{if(!e||0===e.length)return"";const i=e[0].validationState;if(!e.every((({validationState:e})=>e===i))&&1!==e.length)return(e=>{const t={};e.forEach((({fieldName:e,validationState:i})=>{t[i]||(t[i]=[]),t[i].push(e)}));const i=Object.entries(t);i.sort(((e,t)=>t[1].length-e[1].length));const s=i[0][1].length>1?"Fields":"Field";return i.reduce(((e,[t,s],a)=>{const n=i[a][1].length>1?"are":"is",l=s.join(", "),o=((e,t)=>{const i=e.length-1===t,s=e.length-2===t;return i?"":s?" and":","})(i,a);return`${e} ${l} ${n} ${t}${o}`}),s)})(e);switch(e.length){case 1:return`Field ${e[0].fieldName} is ${i}`;case 2:return`Fields ${e[0].fieldName} and ${e[1].fieldName} are ${i}`;case t:return`All fields are ${i}`;default:return(e=>e.reduce(((t,{fieldName:i},s)=>t+(i+((e,t)=>{const i=e[0].validationState,s=e.length-1===t,a=e.length-2===t;return s?` are ${i}`:a?" and":", "})(e,s))),"Fields "))(e)}},w="licensePlate",k="make",D="model",I="year",V="state",C="mileage",O={licensePlateForm:["licensePlateInput","stateInput","mileageInput"],makeModelForm:["makeInput","modelInput","modelYearInput","stateInput","mileageInput"]},B={Row:"row",Column:"column"};const A=class{#e;#t;#i;#s;constructor({hostElementId:e="",selectHandler:t=(()=>{}),layoutType:i=B.Row,selectedOption:s="makeModelForm"}){this.#e=document.getElementById(e),this.#t=t,this.#i=i,this.#a(),this.#t(s)}#a(){Array.from(this.#e.querySelectorAll("label")).forEach((e=>e.addEventListener("click",this.#n.bind(this)))),this.#e.addEventListener("keydown",this.#l.bind(this))}#o(t){return t.closest(`[aria-label="${e}"]`)}#r(e){const t=this.#o(document.activeElement);"forward"===e&&t.nextElementSibling&&this.#h(t.nextElementSibling),"back"===e&&t.previousElementSibling&&this.#h(t.previousElementSibling)}#h(e){if(this.#s)return;const t=e.querySelector('input[type="radio"]')?.id;this.setSelectedOption(t)}#n(e){e.preventDefault(),e.stopPropagation();const t=this.#o(e.target);t&&this.#h(t)}#l(e){switch(e?.key){case"ArrowUp":return void(this.#i===B.Column&&this.#r("back"));case"ArrowLeft":return void(this.#i===B.Row&&this.#r("back"));case"ArrowDown":return void(this.#i===B.Column&&this.#r("forward"));case"ArrowRight":return void(this.#i===B.Row&&this.#r("forward"))}}setSelectedOption=t=>{this.#t(t);Array.from(this.#e.querySelectorAll(`[aria-label="${e}"]`)).forEach((e=>{const i=e.querySelector('input[type="radio"]'),s=e.querySelector("label");i.id===t?(s.tabIndex=0,i.checked=!0,i["aria-checked"]=!0,s.focus()):(s.tabIndex=-1,i["aria-checked"]=!1,i.checked=!1)}))};setLayoutType(e){e&&B.keys.some(e)&&(this.#i=e)}setDisabled=e=>{this.#s=e,this.#e.querySelectorAll("input[type=radio]").forEach((t=>{e?t.setAttribute("disabled",!0):t.removeAttribute("disabled")}))}},M=(e,t)=>e.name>t.name?1:-1,H=(e,t)=>e.name>t.name?-1:1,P=(e,t="ASCENDING")=>e.map((({name:e,value:t},i)=>({name:e.toString(),value:t.toString(),index:i}))).sort("ASCENDING"===t?M:H);const T=class{hasError=!1;isActive=!1;isValid=!1;validationState=u;constructor({hostElementId:e="",inputElementId:t="",initialValue:i="",name:s="",valueRestrictionsHandler:a=((e,t)=>t),isDisabled:n=!1,validationHandler:l=(()=>"valid"),onChangeHandler:o=(()=>{})}){this.hostElement=document.getElementById(e),this.inputElement=this.hostElement.querySelector(`#${t}`),this.value=i,this.name=s,this.handleValueRestrictions=a,this.isDisabled=n,this.isValid=!!i,this.validationState=i?p:u,this.validationHandler=l,this.onChangeHandler=o,i&&this.hostElement.classList.add("valid")}onInput=e=>{const t=this.handleValueRestrictions(this._value,e.target.value);t!==this._value&&(this.hasError&&this.setErrorState(!1),this.onChangeHandler()),this.value=t};setDisabled=e=>{this.isDisabled=e,e?this.inputElement.setAttribute("disabled",!0):this.inputElement.removeAttribute("disabled")};setErrorState=e=>{this.hasError=e,this.hostElement.classList.toggle("error",e)};setActiveState=e=>{this.isActive=e,this.hostElement.classList.toggle("isActive",e)};setValidationState=e=>{this.isValid=e===p,this.validationState=e,this.hostElement.classList.toggle("valid",this.isValid)};handleValidation=(...e)=>{this.setValidationState(this.validationHandler(...e))};get value(){return this._value}set value(e=""){this.inputElement.value=e,this._value=e,""===this.value&&this.hostElement.classList.remove("valid")}},N={DOWN:"down",UP:"up"};function _(e,t=N.DOWN){return e?e.hasAttribute("hidden")?_(t===N.DOWN?e.nextElementSibling:e.previousElementSibling,t):e:null}const W=class{#d=null;#u=null;#e=null;#c=[];#m="";#p=!1;#t=()=>{};#E;constructor({hostElementId:e="",options:t=[],ariaLabel:i="",selectHandler:s,name:n=""}){this.#e=document.getElementById(e),this.#c=t,this.#m=i,this.#E=n,a(s)&&(this.#t=s),this.#b(),this.#a(),this.#e.appendChild(this.#d)}#g=({name:e,value:t,index:i})=>{const s=document.createElement("li");return s.tabIndex=-1,s.dataset.value=t,s.dataset.name=e,s.dataset.index=i,s.textContent=e,s.role="option",s};#v(e=[]){return e.map(this.#g)}#f(e){this.#u.replaceChildren(...this.#v(e))}#S(){this.#u=document.createElement("ul"),this.#u.role="listbox",this.#u.setAttribute("aria-label",this.#m),this.#f(this.#c)}#b(){this.#S(),this.#d=document.createElement("div"),this.#d.classList.add("options_list"),this.#d.appendChild(this.#u)}#y(e){if(this.#p)return;const t=document.activeElement||this.#u.children[0];if(e===N.DOWN){const e=_(t.nextElementSibling,N.DOWN)||_(this.#u.children[0],N.DOWN);e&&e.focus()}if(e===N.UP){const e=_(t.previousElementSibling,N.UP)||_(this.#u.children[this.#u.children.length-1],N.UP);e&&e.focus()}}#l(e){switch(e.key){case"Tab":e.shiftKey||(e.stopPropagation(),e.preventDefault(),this.#F(e.target));break;case"Enter":e.stopPropagation(),e.preventDefault(),this.#F(e.target);break;case"ArrowDown":e.preventDefault(),e.stopPropagation(),this.#y(N.DOWN);break;case"ArrowUp":e.preventDefault(),this.#y(N.UP)}}#a(){this.#u.addEventListener("keydown",this.#l.bind(this)),this.#u.addEventListener("click",this.#L.bind(this))}#F(e){const t=(i=e)&&"LI"===i.nodeName?i.dataset:null;var i;t&&t.name&&(this.#t(t.name),this.setSelectedOption(t.name))}#L(e){e.stopPropagation(),this.#F(e.target)}updateOptions(e=[]){e.length>0&&(this.#c=e),this.#f(this.#c)}#w=()=>{const e=document.createElement("li");return e.classList.add("empty_list_error_message"),e.textContent=`${this.#E} not found`,e.setAttribute("aria-label","not found error message"),e};#k=()=>{if(this.#p)this.#u.replaceChildren(this.#w());else{const e=this.#u.querySelector(".empty_list_error_message");e&&e.remove()}};setVisibleOptions(e=[]){0===e.length?this.#p||(this.#p=!0,this.#k()):(this.#p&&(this.#p=!1,this.#k()),this.#f(e))}getVisibleOptions=()=>this.#p?[]:((e=[])=>e.map((e=>e&&e.dataset&&e.dataset.name?{name:e.dataset.name,value:e.dataset.value||""}:null)).filter(Boolean))(Array.from(this.#u.children));#D=()=>{const e=this.#u.querySelector(".csw-selected-option");e&&e.classList.remove("csw-selected-option")};setSelectedOption=e=>{this.#D();const t=this.#u.querySelector(`[data-name="${e}"]`);t&&t.classList.add("csw-selected-option")};focus(){if(this.#p)return;const e=_(this.#u.children[0],N.DOWN);e&&e.focus()}};const x=class{inputField=null;backButton=null;constructor(e="",t=20){this.createFilterBar(e,t)}produceBackButton=()=>{const e=document.createElement("button");return e.classList.add("combobox_filter_bar_back_button"),e.ariaLabel="close combobox",this.backButton=e,e};produceFilterInput=(e,t)=>{const i=document.createElement("input");return i.type="text",i.id=s(),i.classList.add("combobox_filter_bar_filter_input"),i.placeholder=e,i.maxLength=t,this.inputField=i,i};produceWrapper=()=>{const e=document.createElement("div");return e.classList.add("combobox_filter_bar"),e};createFilterBar=(e,t)=>{const i=this.produceWrapper();i.appendChild(this.produceBackButton()),i.appendChild(this.produceFilterInput(e,t)),this.element=i};unmount=()=>{this.element.remove()}};const R=class{element=null;constructor(){this.#I()}#I=()=>{const e=document.createElement("div");e.classList.add("combobox_close_layer"),this.element=e};unmount=()=>{this.element.remove()}};const $=class extends T{#c=[];#V=null;#C=null;#O=null;#B=s();#A=!1;#M=!1;#H=null;#P="";#T;#N;#_;#W;#x;#t;#R="";selectedValue="";#$=20;#z;#q;constructor({hostElementId:e="",inputElementId:t="",options:i=[],isMobileView:s=!1,filterInputPlaceholder:a="",isDisabled:n=!1,valueRestrictionsHandler:l=((e,t)=>t),name:o="",searchBy:r=["name"],sortingType:h="ASCENDING",initialValue:d="",validationHandler:u,selectHandler:c=(()=>{}),autocompleteStrategy:m=(()=>!1),handleFilterVisibleOptions:p=(()=>[]),onFocus:E=(()=>{}),onBlur:b=(()=>{}),onChangeHandler:g,maxLength:v=20}){super({hostElementId:e,inputElementId:t,initialValue:d,name:o,valueRestrictionsHandler:l,isDisabled:n,validationHandler:u,onChangeHandler:g}),this.#x=e,this.#M=s,this.#c=P(i,h),this.#P=a,this.#T=r,this.#N=h,this.#_=m,this.#W=p,this.#t=c,this.#z=E,this.#q=b,this.#$=v,t&&this.hostElement&&(this.inputElement=this.hostElement.querySelector(`#${t}`)),this.#b(),this.#V=new W({hostElementId:this.#B,options:this.#c,selectHandler:this.#j,name:o}),d&&(this.selectedValue=d,this.setSelectedOptionName(d),this.hostElement.classList.add("valid")),this.#a()}#h=e=>{this.setValue(e),this.handleClose()};#j=e=>{this.inputElement.focus(),this.#h(e)};#G=()=>{let e=null;const t=this.#V.getVisibleOptions();e=1===t.length?t[0]:this.#_(this._value,this.#c),e&&this.selectedValue!==this.value&&(this.#h(e.name),this.setSelectedOptionName(e.name))};#Y=e=>{e.preventDefault(),e.stopPropagation(),this.#M&&this.#C.inputField.value!==this.inputElement.value&&(this.#C.inputField.value=this.inputElement.value,this._value=this.inputElement.value),this.handleClose()};#U=e=>{const t=this.value;this.onInput(e),this.#R=e.target.value,t!==this.value&&(this.onChangeHandler(this.value),!this.#A&&this.handleOpen()),this.#K(this.#R)};#Z=()=>{setTimeout((()=>{this.#A||(this.#G(),this.validate(),document.activeElement!==this.inputElement&&this.#J())}),150)};#Q=e=>{const t=this.handleValueRestrictions(this.#R,e.target.value);this.#C.inputField.value=t,this.#K(t)};#X=e=>{if("ArrowDown"===e.key)return e.preventDefault(),this.handleOpen(),void this.#V.focus()};#ee=e=>{switch(e.key){case"Tab":this.handleClose();break;case"Escape":e.preventDefault(),this.#A?(this.handleClose(),this.inputElement.focus()):""!==this._value&&(this._value="",this.#V.setVisibleOptions(this.#c),this.inputElement.value="",this.#t&&this.#t(""))}};#te=()=>{this.#z(),this.setActiveState(!0)};#J=()=>{this.#q(),this.setActiveState(!1)};#ie=()=>{this.#M?(this.#O=new R,this.#C=new x(this.#P,this.#$),this.inputElement.setAttribute("readonly",this.#M),this.#H.prepend(this.#C.element),this.hostElement.appendChild(this.#O.element),this.#C.inputField.addEventListener("input",this.#Q),this.#C.inputField.value=this._value,this.#C.backButton.addEventListener("click",this.#Y),this.#O.element.addEventListener("click",this.#Y)):(this.#C.unmount(),this.#O.unmount(),this.inputElement.removeAttribute("readonly"),this.inputElement.addEventListener("focus",this.#te),this.inputElement.addEventListener("blur",this.#Z),this.inputElement.addEventListener("keydown",this.#X))};#se=()=>{const e=window.innerWidth<1024;e!==this.#M&&(this.#M=e,this.#ie())};#b=()=>{this.#O=new R,this.#H=document.createElement("div"),this.#H.id=this.#B,this.#H.className="combobox_wrapper",this.#M&&(this.#C=new x(this.#P,this.#$),this.#H.appendChild(this.#C.element),this.hostElement.appendChild(this.#O.element)),this.hostElement.appendChild(this.#H)};#ae=()=>{this.hostElement.addEventListener("click",this.handleOpen),this.hostElement.addEventListener("keydown",this.#ee),this.inputElement.addEventListener("focus",this.#te),this.inputElement.addEventListener("input",this.#U),this.inputElement.addEventListener("blur",this.#Z),this.inputElement.addEventListener("keydown",this.#X),this.#M&&(this.#C.inputField.addEventListener("input",this.#Q),this.#C.backButton.addEventListener("click",this.#Y),this.#O.element.addEventListener("click",this.#Y)),window.addEventListener("resize",((e,t)=>{let i=null;return(...s)=>{window.clearTimeout(i),i=window.setTimeout((()=>{e.apply(null,s)}),t)}})(this.#se,100)),document.addEventListener("click",(e=>{e.target.closest(`#${this.#x}`)||(this.handleClose(),this.isActive&&this.#Z())}))};#a=()=>{this.#ae(),this.hostElement.classList.add("closed"),this.hostElement.classList.add("combobox"),this.#M&&this.inputElement.setAttribute("readonly",!0),this.isDisabled&&this.inputElement.setAttribute("disabled",!0)};#K=e=>{this.#V.setVisibleOptions(this.#W(e,this.#c,this.#T))};updateOptions=e=>{this.value="",this.selectedValue="",this.#c=P(e,this.#N),this.#V.updateOptions(this.#c)};handleOpen=()=>{this.isDisabled||(this.#A=!0,this.hostElement.classList.remove("closed"),this.hostElement.classList.add("open"),this.#te())};handleClose=()=>{this.#A=!1,this.hostElement.classList.remove("open"),this.hostElement.classList.add("closed")};validate=()=>{this.handleValidation(this._value,this.#c),this.isValid||(this.value="",this.#R="",this.#V.updateOptions([]))};setValue=(e="")=>{this.value=e,this.selectedValue=e,this.#R="",this.#K(this.#R),this.#M&&(this.#C.inputField.value=e),this.setErrorState(!1),this.setValidationState(!0),this.setSelectedOptionName(e),this.#t(e),this.onChangeHandler()};setSelectedOptionName=e=>{e&&(this.#V.setSelectedOption(e),this.hostElement.classList.add("valid"))};resetFilter=()=>{this.#R="",this.#M&&(this.#C.inputField.value="")};focus=()=>{this.handleOpen(),this.inputElement.focus()}};const z=class{#ne=null;#le=null;constructor({hostElementId:e="",submitHandler:t}){this.#ne=document.getElementById(e),this.#le=a(t)?t:()=>{},this.#ne&&this.#oe()}setDisabled(e){e?this.#ne.setAttribute("disabled",!0):this.#ne.removeAttribute("disabled")}setLoading(e){this.#ne.classList.toggle("loading",e)}#n(e){e.preventDefault(),this.#le()}#oe(){this.#ne.addEventListener("click",this.#n.bind(this))}};const q=class extends T{hasError=!1;#z;#q;constructor({hostElementId:e="",inputElementId:t="",initialValue:i="",name:s="",valueRestrictionsHandler:a=((e,t)=>t),validationHandler:n=(()=>!0),isDisabled:l=!1,onChangeHandler:o,onFocus:r=(()=>{}),onBlur:h=(()=>{})}){super({hostElementId:e,inputElementId:t,initialValue:i,name:s,valueRestrictionsHandler:a,isDisabled:l,validationHandler:n,onChangeHandler:o}),this.#z=r,this.#q=h,this.hostElement&&this.#oe()}validate=()=>{this.handleValidation(this._value)};setValue=(e="")=>{e&&(this.value=e,this.setErrorState(!1),this.setValidationState(!0))};#te=()=>{this.#z(),this.setActiveState(!0)};#Z=()=>{this.validate(),this.#q(),this.setActiveState(!1)};#oe=()=>{this.isDisabled&&this.setDisabled(!0),this.inputElement.addEventListener("focus",this.#te),this.inputElement.addEventListener("input",this.onInput),this.inputElement.addEventListener("blur",this.#Z)}},j={formType:"makeModelForm",licensePlate:"",make:"",model:"",year:"",mileage:"",state:""},G="licensePlateField",Y="mileageField",U="stateField",K="makeField",Z="modelField",J="modelYearField",Q="licensePlateInput",X="mileageInput",ee="stateInput",te="makeInput",ie="modelInput",se="modelYearInput";const ae=class{root=null;hasError=!1;errorMessage="";#re;#he;#de="makeModelForm";#M;#ue;#ce=null;licensePlateInput=null;makeInput=null;modelInput=null;modelYearInput=null;stateInput=null;mileageInput=null;#me=null;#pe=!1;focusedFields=new Set;constructor({hostId:e="searchWidget",widgetType:t=y,desktopStartBreakpoint:i=1024,onLicensePlateError:s=(()=>{}),onEmptyFieldsError:a=(()=>{}),onSubmit:n=(()=>{}),initialData:l=j,carsData:o={},statesData:r=[],yearsData:h=[],makesData:d=[],modelData:u=[]}){this.#he=document.getElementById(e),this.#re=t,this.#M=window.innerWidth<i,this.onLicensePlateError=s,this.onEmptyFieldsError=a,this.onSubmit=n,this.initialData=l,this.carsData=o,this.statesData=r,this.yearsData=h,this.modelData=u,this.makesData=d,this.#oe()}#Ee=e=>O[e].map((e=>this[e]));#be=e=>{this.#me.setDisabled(e),this.#ce.setDisabled(e),this.#Ee(this.#de).forEach((t=>{t.setDisabled(e)}))};setFormLoadingStatus=(e=!1)=>{this.#be(e),this.#pe=e,this.#me.setLoading(e),this.#he.classList.toggle("isLoading",e)};#ge=e=>{this.onEmptyFieldsError(e)};#ve=()=>{this.#ge(""),this.hasError=!1,this.#me.setDisabled(!1)};#fe=e=>{this.#Ee(e).map((e=>e&&e.setErrorState(!1)))};#Se=()=>{this.errorMessage="",this.#ge("");const e=this.#Ee(this.#de).every((e=>!e.hasError));this.#pe||this.#me.setDisabled(!e)};#ye=e=>{""===e&&(this.#ue="",this.modelInput.value="",this.modelInput.selectedValue="",this.modelInput.updateOptions([]),this.modelInput.setDisabled(!0)),this.#Se()};#Fe=()=>{const e=[];this.#Ee(this.#de).forEach((t=>{t.validate(),t.isValid&&t.value||(t.setErrorState(!0),e.push(t))})),this.hasError=e.length>0,this.hasError&&(this.errorMessage=L(e.map((e=>({fieldName:e.name,validationState:e.validationState}))),this.#Ee(this.#de).length))};#Le=()=>{const e=this.#we();!e.licencePlate||e.licencePlate.length<2||!e.shortStateValue||((e,t)=>{const i={plate:e,state:t};return fetch("https://platetovin.net/api/convert",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"5ICpITb9gAI9Yiv"},body:JSON.stringify(i)})})(e.licencePlate,e.shortStateValue).then((e=>e.json())).then((t=>{t.success?(this.#re===F&&this.setFormLoadingStatus(!1),this.onSubmit(this.#we())):(this.#me.setDisabled(!0),this.hasError=!0,this.setFormLoadingStatus(!1),this.onLicensePlateError({errorMessage:v(t.message),licensePlate:e.licencePlate,state:e.state,odometer:e.searchMileage}))})).catch(((t={message:""})=>{this.#me.setDisabled(!0),this.hasError=!0,this.setFormLoadingStatus(!1),this.onLicensePlateError({errorMessage:v(t.message),licensePlate:e.licencePlate,state:e.state,odometer:e.mileage})}))};#we=()=>((e,t)=>{const i={};return e.forEach((e=>{const{name:s,value:a}=e;switch(s){case w:i.licencePlate=a;break;case C:i.searchMileage=a;break;case k:i.make=a;break;case D:i.model=a;break;case I:i.year=a;break;case V:i.shortStateValue=((e,t)=>{if(!e||!t)return"";const i=t.find((({name:t})=>t===e));return i&&i.value?i.value:""})(a,t),i.state=a}})),i})(this.#Ee(this.#de),this.statesData);#ke=()=>{if(this.#Fe(),this.#pe=!0,this.#me.setDisabled(!0),this.hasError)return this.#ge(this.errorMessage),void(this.#pe=!1);this.setFormLoadingStatus(!0)};#De=e=>{e&&e in this.carsData&&(this.modelData=this.carsData[e].models||[],this.modelInput.updateOptions(this.modelData),this.modelInput.setDisabled(!this.makesData||0===this.makesData.length))};#Ie=e=>{this.#ue!==e&&(this.#ue=e,this.#De(e),this.modelInput.resetFilter(),this.modelInput.focus())};#Ve(e){switch(e){case"licensePlateForm":this.#he.classList.remove(S),this.#he.classList.add(f);break;case"makeModelForm":this.#he.classList.remove(f),this.#he.classList.add(S)}}#Ce(e=""){e in O&&(this.#Ve(e),this.#ve(),this.#fe(this.#de),this.#de=e)}setFormData=e=>{const{formType:t}=e;t&&this.#ce.setSelectedOption(t),this.#Ee(this.#de).forEach((t=>{e[t.name]&&t.setValue(e[t.name])}))};populateMakeModel=(e,t)=>{e&&(this.#ue=e,this.#De(e)),t&&(this.modelInput.value=t,this.modelInput.setSelectedOptionName(t))};setFocusState=(e,t)=>()=>{e?this.focusedFields.add(t):this.focusedFields.delete(t),this.#he.classList.toggle("focus_state",this.focusedFields.size>0)};#oe(){this.#me=new z({hostElementId:"formSubmitButton",submitHandler:this.#ke}),this.#ce=new A({hostElementId:"searchWidgetRadioGroup",selectHandler:this.#Ce.bind(this),selectedOption:this.#de,layoutType:B.Row}),this.licensePlateInput=new q({name:w,hostElementId:G,inputElementId:Q,validationHandler:E.licensePlate,valueRestrictionsHandler:n.lettersAndNumbers,onChangeHandler:this.#Se,initialValue:this.initialData.licensePlate||"",onFocus:this.setFocusState(!0,w),onBlur:this.setFocusState(!1,w)}),this.mileageInput=new q({name:C,hostElementId:Y,inputElementId:X,valueRestrictionsHandler:n.numbersOnly,validationHandler:E.mileage,onChangeHandler:this.#Se,initialValue:this.initialData.mileage||"",onFocus:this.setFocusState(!0,C),onBlur:this.setFocusState(!1,C)}),this.stateInput=new $({name:V,hostElementId:U,inputElementId:ee,options:this.statesData,isMobileView:this.#M,valueRestrictionsHandler:n.lettersOnly,searchBy:["name","value"],autocompleteStrategy:r.state,handleFilterVisibleOptions:d.startsWidth,validationHandler:E.matchOptionNameProp,onChangeHandler:this.#Se,filterInputPlaceholder:"Select registration state",initialValue:this.initialData.state||"",onFocus:this.setFocusState(!0,V),onBlur:this.setFocusState(!1,V)}),this.makeInput=new $({name:k,hostElementId:K,inputElementId:te,options:this.makesData,isMobileView:this.#M,valueRestrictionsHandler:n.lettersOnly,selectHandler:this.#Ie,onChangeHandler:this.#ye,autocompleteStrategy:r.makeModel,handleFilterVisibleOptions:d.startsWidth,validationHandler:E.matchOptionNameProp,filterInputPlaceholder:"What car do you own?",initialValue:this.initialData.make||"",onFocus:this.setFocusState(!0,k),onBlur:this.setFocusState(!1,k)}),this.modelInput=new $({name:D,hostElementId:Z,inputElementId:ie,options:this.modelData,isMobileView:this.#M,valueRestrictionsHandler:n.carModelCharacters,validationHandler:E.matchOptionNameProp,autocompleteStrategy:r.makeModel,handleFilterVisibleOptions:d.startsWidth,onChangeHandler:this.#Se,isDisabled:!0,filterInputPlaceholder:"Add car model",initialValue:this.initialData.model||"",onFocus:this.setFocusState(!0,D),onBlur:this.setFocusState(!1,D)}),this.modelYearInput=new $({name:I,hostElementId:J,inputElementId:se,options:this.yearsData,isMobileView:this.#M,valueRestrictionsHandler:n.numbersOnly,sortingType:"DESCENDING",autocompleteStrategy:r.modelYear,handleFilterVisibleOptions:d.startsOrEndsWidth,validationHandler:E.matchOptionNameProp,onChangeHandler:this.#Se,filterInputPlaceholder:"Add year",initialValue:this.initialData.year||"",maxLength:4,onFocus:this.setFocusState(!0,I),onBlur:this.setFocusState(!1,I)}),this.#he.addEventListener("submit",(e=>{e.preventDefault(),this.#ke()})),this.initialData.make&&populateMakeModel(this.initialData.make,this.initialData.model)}};window.SearchWidget=class{errorMessage="";constructor({initialData:e,onLicensePlateError:t=(()=>{}),onSubmit:i=(()=>{})}){this.initialize({initialData:e,onLicensePlateError:t,onSubmit:i})}async initialize({initialData:e,onLicensePlateError:s,onSubmit:a}){const n=await async function(){return await fetch(t).then((e=>e.json())).catch((()=>[]))}(),l=await async function(){return await fetch(i).then((e=>e.json())).catch((()=>[]))}(),o=function(){const e=(new Date).getFullYear();return new Array(25).fill(null).map(((t,i)=>{const s=(e-i).toString();return{name:s,value:s}}))}(),r=((e={})=>Object.entries(e).map((([e,{id:t,name:i}])=>({name:i,value:t.toString()}))))(n);this.searchWidget=new ae({widgetType:F,onLicensePlateError:s,onSubmit:a,initialData:e,carsData:n,statesData:l,yearsData:o,makesData:r})}}})();